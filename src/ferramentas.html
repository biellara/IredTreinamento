<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ferramentas de IA | IRED</title>

    <!-- Fontes e √çcones -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&display=swap" rel="stylesheet" />
    <link
        rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
    />

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/showdown/2.1.0/showdown.min.js"></script>

    <!-- CSS Customizado -->
    <link rel="stylesheet" href="style.css" />
</head>
<body>
    <script src="auth.js"></script>
        <script>
        protectPage(); // Redireciona para login.html se n√£o tiver token
        </script>
    <!-- Cabe√ßalho com Navega√ß√£o Principal -->
    <header class="page-header">
        <a href="index.html" class="back-button" id="home-button">
            <i class="fa-solid fa-house"></i>
            <span>In√≠cio</span>
        </a>
        <!-- Este bot√£o agora √© um link, pois sua fun√ß√£o √© navega√ß√£o -->
        <a href="#" class="back-button" id="back-to-tools-button" style="display: none;">
            <i class="fa-solid fa-arrow-left"></i>
            <span>Voltar para Ferramentas</span>
        </a>
    </header>

    <!-- Container principal da p√°gina -->
    <main class="page-container">
        <div id="tool-wrapper" class="hub-content">
            <!-- SE√á√ÉO 1: MENU DE SELE√á√ÉO DE FERRAMENTAS -->
            <!-- Usando <section> para delinear uma se√ß√£o importante da p√°gina -->
            <section id="view-tool-selection" class="view active">
                <h1 class="hub-title">Ferramentas de IA</h1>
                <p class="hub-subtitle">Selecione uma ferramenta para otimizar seu atendimento.</p>
                <!-- A tag <nav> aqui est√° correta para um menu de navega√ß√£o -->
                <nav class="hub-nav">
                    <a href="#" class="hub-button tool-card" data-target="diagnostico">
                        <i class="fa-solid fa-heart-pulse"></i>
                        <span>Diagn√≥stico Inteligente</span>
                    </a>
                    <a href="#" class="hub-button tool-card" data-target="simulador">
                        <i class="fa-solid fa-comments"></i>
                        <span>Simulador de Atendimento</span>
                    </a>
                    <a href="#" class="hub-button tool-card" data-target="relatorio">
                        <i class="fa-solid fa-file-pen"></i>
                        <span>Gerador de Relat√≥rios</span>
                    </a>
                </nav>
            </section>

            <!-- SE√á√ÉO 2: INTERFACE DA FERRAMENTA ATIVA -->
            <!-- Esta se√ß√£o receber√° o conte√∫do da ferramenta ativa -->
            <section id="view-tool-interface" class="view"></section>
        </div>
    </main>

    <!-- ===================================================================== -->
    <!-- TEMPLATES DAS FERRAMENTAS -->
    <!-- O uso da tag <template> est√° correto e √© uma √≥tima pr√°tica. -->
    <!-- ===================================================================== -->

    <template id="template-diagnostico">
        <!-- Cada ferramenta agora √© um <form> para melhor sem√¢ntica -->
        <form class="tool-interface-container">
            <header>
                <!-- T√≠tulo da ferramenta rebaixado para <h2> para hierarquia correta -->
                <h2 class="view-title">‚ú® Diagn√≥stico Inteligente</h2>
                <p class="view-subtitle">
                    Descreva o problema do cliente para receber uma an√°lise e sugest√£o de a√ß√£o.
                </p>
            </header>
            <div class="card" style="margin-top: 2rem;">
                <div>
                    <label
                        for="problemDescription"
                        style="font-weight: 700; display: block; margin-bottom: 0.5rem;"
                        >Descri√ß√£o do problema:</label
                    >
                    <textarea
                        id="problemDescription"
                        rows="4"
                        class="form-textarea"
                        placeholder="Ex: 'Minha internet est√° caindo toda hora na TV...'"
                    ></textarea>
                </div>
                <!-- O tipo "button" evita que o bot√£o envie o formul√°rio por padr√£o -->
                <button type="button" id="analyzeBtn" class="button button-red" style="margin-top: 1rem; width: 100%;">
                    Analisar Problema
                </button>
                <div id="ai-loader" class="loader-container" style="display:none;">
                    <i
                        class="fa-solid fa-circle-notch fa-spin"
                        style="color: var(--brand-red); font-size: 1.875rem;"
                    ></i>
                    <p>Aguardando resposta da IA...</p>
                </div>
                <!-- A tag <article> pode ser usada para agrupar resultados aut√¥nomos -->
                <article id="ai-results" style="display: none; margin-top: 1.5rem;">
                    <section>
                        <h3 class="results-title">üìã An√°lise R√°pida:</h3>
                        <div id="diagnosis-output" class="results-box prose"></div>
                    </section>
                    <section style="margin-top: 1.5rem;">
                        <h3 class="results-title">üí¨ Sugest√£o de Abertura:</h3>
                        <div id="script-output" class="results-box prose"></div>
                    </section>
                </article>
            </div>
        </form>
    </template>

    <template id="template-simulador">
        <div class="tool-interface-container">
            <!-- Vis√£o de Configura√ß√£o da Simula√ß√£o -->
            <section id="sim-setup-view">
                 <form>
                    <header>
                        <h2 class="view-title">üí¨ Simulador de Atendimento</h2>
                        <p class="view-subtitle">Escolha um cen√°rio e pratique suas habilidades de comunica√ß√£o.</p>
                    </header>
                    <div class="card" style="margin-top: 2rem;">
                        <div>
                           <label
                                for="scenarioSelect"
                                style="font-weight: 700; display: block; margin-bottom: 0.5rem;"
                                >Selecione um cen√°rio:</label
                            >
                            <select id="scenarioSelect" class="form-select">
                                <option value="lentidao-frustrado">Cliente frustrado com lentid√£o</option>
                                <option value="wifi-nao-funciona-leigo">Cliente leigo com Wi-Fi que "n√£o funciona no quarto"</option>
                                <option value="quedas-constantes-irritado">Cliente irritado com quedas constantes</option>
                                <option value="velocidade-baixa-cabo">Cliente com velocidade baixa no cabo</option>
                                <option value="problemas-com-dvr">Cliente problemas de DVR</option>
                            </select>
                        </div>
                        <button
                            type="button"
                            id="startSimBtn"
                            class="button button-blue"
                            style="margin-top: 1rem; width: 100%;"
                        >
                            Iniciar Simula√ß√£o
                        </button>
                    </div>
                 </form>
            </section>
            <!-- Vis√£o do Chat da Simula√ß√£o -->
            <section
                id="sim-chat-view"
                style="display: none; flex-direction: column; height: calc(100vh - 10rem);"
            >
                <h2 class="view-title">Simula√ß√£o em Andamento...</h2>
                <div
                    style="flex: 1; display: flex; flex-direction: column; margin-top: 2rem; overflow: hidden;"
                >
                    <div id="chat-history"><!-- Conte√∫do do chat --></div>
                    <div id="sim-loader" class="loader-container">
                        <p>Cliente-rob√¥ est√° digitando...</p>
                    </div>
                    <!-- O chat em si √© um formul√°rio de envio de mensagens -->
                    <form style="margin-top: auto; display: flex; gap: 0.5rem;">
                        <input
                            type="text"
                            id="chat-input"
                            class="form-input"
                            placeholder="Digite sua resposta..."
                            style="flex-grow: 1;"
                        />
                        <button type="submit" id="sendChatBtn" class="button button-blue">
                            <i class="fa-solid fa-paper-plane"></i>
                        </button>
                    </form>
                </div>
                <button
                    type="button"
                    id="endSimBtn"
                    class="button button-red"
                    style="margin-top: 1rem; width: 100%;"
                >
                    Finalizar e Pedir Feedback
                </button>
            </section>
            <!-- Vis√£o de Feedback da Simula√ß√£o -->
            <section id="sim-feedback-view" style="display: none;">
                <h2 class="view-title">‚≠ê Avalia√ß√£o do Atendimento</h2>
                <div class="card" style="margin-top: 2rem;">
                    <div id="feedback-results" class="results-box prose"></div>
                    <button type="button" id="restartSimBtn" class="button button-blue" style="margin-top: 1.5rem; width: 100%;">
                        Iniciar Nova Simula√ß√£o
                    </button>
                </div>
            </section>
        </div>
    </template>

    <template id="template-relatorio">
        <form class="tool-interface-container">
            <header>
                <h2 class="view-title">üìù Gerador de Relat√≥rio</h2>
                <p class="view-subtitle">
                    Transforme um resumo simples em um relat√≥rio t√©cnico completo.
                </p>
            </header>
            <div class="card" style="margin-top: 2rem;">
                <div>
                    <label
                        for="reportSummary"
                        style="font-weight: 700; display: block; margin-bottom: 0.5rem;"
                        >Resumo informal do atendimento:</label
                    >
                    <textarea
                        id="reportSummary"
                        rows="4"
                        class="form-textarea"
                        placeholder="Ex: cliente com lentid√£o na netflix, alterado canal do wi-fi para 11, problema resolvido."
                    ></textarea>
                </div>
                <button
                    type="button"
                    id="generateReportBtn"
                    class="button button-green"
                    style="margin-top: 1rem; width: 100%;"
                >
                    Gerar Relat√≥rio T√©cnico
                </button>
                <div id="report-loader" class="loader-container" style="display:none;">
                    <i
                        class="fa-solid fa-circle-notch fa-spin"
                        style="color: var(--brand-green); font-size: 1.875rem;"
                    ></i>
                    <p>Aguardando resposta da IA...</p>
                </div>
                <div id="report-results" style="display: none; margin-top: 1.5rem;">
                    <h3 class="results-title">Relat√≥rio Gerado:</h3>
                    <div>
                        <textarea
                            id="report-output"
                            rows="10"
                            class="form-textarea"
                            readonly
                            aria-label="Relat√≥rio t√©cnico gerado"
                            style="margin-top: 0.5rem;"
                        ></textarea>
                    </div>
                    <button
                        type="button"
                        id="copyReportBtn"
                        class="button button-green"
                        style="margin-top: 0.5rem; width: 100%;"
                    >
                        <span
                            id="copyBtnTextContainer"
                            style="display: flex; align-items: center; justify-content: center; gap: 0.5rem;"
                        >
                            <i class="fa-solid fa-copy"></i>
                            <span>Copiar Relat√≥rio</span>
                        </span>
                    </button>
                </div>
            </div>
        </form>
    </template>

    <!-- Scripts da P√°gina -->
    <!-- Adicionado 'defer' para garantir carregamento n√£o bloqueante e execu√ß√£o na ordem correta -->
    <script src="ferramentas.js" defer></script>
    <script src="script.js" defer></script>
</body>
</html>
